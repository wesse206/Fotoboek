"use strict";(self.webpackChunkjaarboek=self.webpackChunkjaarboek||[]).push([[250],{250:(y,g,o)=>{o.r(g),o.d(g,{NestedAppAuthController:()=>I});var d=o(861),T=o(214),m=o(979),l=o(593),R=o(341),C=o(441),v=o(82),h=o(140),A=o(841),N=o(498),k=o(544),E=o(481),u=function(c){return c.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",c.USER_CANCEL="USER_CANCEL",c.NO_NETWORK="NO_NETWORK",c.TRANSIENT_ERROR="TRANSIENT_ERROR",c.PERSISTENT_ERROR="PERSISTENT_ERROR",c.DISABLED="DISABLED",c.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE",c.NESTED_APP_AUTH_UNAVAILABLE="NESTED_APP_AUTH_UNAVAILABLE",c}(u||{});class S{constructor(e,t,r,i){this.clientId=e,this.clientCapabilities=t,this.crypto=r,this.logger=i}toNaaSilentTokenRequest(e){let t;return t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters)),{userObjectId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:this.crypto.createNewGuid(),prompt:void 0!==e.prompt?e.prompt:"",claims:void 0!==e.claims?e.claims:"",authenticationScheme:void 0!==e.authenticationScheme?e.authenticationScheme:"",clientCapabilities:this.clientCapabilities,extraParameters:t}}toNaaTokenRequest(e){let t;return t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters)),{userObjectId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:"",prompt:void 0!==e.prompt?e.prompt:"",nonce:void 0!==e.nonce?e.nonce:"",claims:void 0!==e.claims?e.claims:"",state:void 0!==e.state?e.state:"",authenticationScheme:void 0!==e.authenticationScheme?e.authenticationScheme:"",clientCapabilities:void 0,extraParameters:t}}fromNaaTokenResponse(e,t){const r=new Date(C.I.nowSeconds()+1e3*(t.expires_in||0)),i=this.fromNaaAccountInfo(t.account);return{authority:t.account.environment,uniqueId:t.account.homeAccountId,tenantId:t.account.tenantId,scopes:t.scope.split(" "),account:this.fromNaaAccountInfo(t.account),idToken:void 0!==t.id_token?t.id_token:"",idTokenClaims:void 0!==i.idTokenClaims?i.idTokenClaims:{},accessToken:t.access_token,fromCache:!0,expiresOn:r,tokenType:void 0!==e.authenticationScheme?e.authenticationScheme:"Bearer",correlationId:e.correlationId,requestId:"",extExpiresOn:r,state:t.state}}fromNaaAccountInfo(e){let t;return t=void 0!==e.idToken?v.Z_(e.idToken,this.crypto.base64Decode):void 0,{homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.tenantId,username:e.username,localAccountId:e.localAccountId,name:e.name,idToken:e.idToken,idTokenClaims:t}}fromBridgeError(e){if(!function U(c){return void 0!==c.status}(e))return new E.l4("unknown_error","An unknown error occurred");switch(e.status){case u.USER_CANCEL:return new h.er(A.$R);case u.NO_NETWORK:return new h.er(A.Mq);case u.ACCOUNT_UNAVAILABLE:return new h.er(A.cX);case u.DISABLED:return new h.er(A.Ls);case u.NESTED_APP_AUTH_UNAVAILABLE:return new h.er(e.code,e.description);case u.TRANSIENT_ERROR:case u.PERSISTENT_ERROR:return new N.n(e.code,e.description);case u.USER_INTERACTION_REQUIRED:return new k.Yo(e.code,e.description);default:return new E.l4(e.code,e.description)}}}const f_unsupportedMethod_code="unsupported_method",f_unsupportedMethod_desc="The PKCE code challenge and verifier could not be generated.";class n extends E.l4{constructor(e,t){super(e,t),Object.setPrototypeOf(this,n.prototype),this.name="NestedAppAuthError"}static createUnsupportedError(){return new n(f_unsupportedMethod_code,f_unsupportedMethod_desc)}}var w=o(76),p=o(97);class I{constructor(e){this.operatingContext=e;const t=this.operatingContext.getBridgeProxy();if(void 0===t)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=t,this.config=e.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=e.isBrowserEnvironment()?new R.Q(this.logger,this.performanceClient):T.d,this.eventHandler=new w.b(this.logger,this.browserCrypto),this.nestedAppAuthAdapter=new S(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger)}getBrowserStorage(){throw n.createUnsupportedError()}getEventHandler(){return this.eventHandler}static createController(e){return(0,d.Z)(function*(){const t=new I(e);return Promise.resolve(t)})()}initialize(){return Promise.resolve()}acquireTokenInteractive(e){var t=this;return(0,d.Z)(function*(){t.eventHandler.emitEvent(p.t.ACQUIRE_TOKEN_START,l.s_.Popup,e);const r=t.performanceClient.startMeasurement(m.Ak.AcquireTokenPopup,e.correlationId);r?.add({nestedAppAuthRequest:!0});try{const i=t.nestedAppAuthAdapter.toNaaTokenRequest(e),s=yield t.bridgeProxy.getTokenInteractive(i),a=t.nestedAppAuthAdapter.fromNaaTokenResponse(i,s);return t.operatingContext.setActiveAccount(a.account),t.eventHandler.emitEvent(p.t.ACQUIRE_TOKEN_SUCCESS,l.s_.Popup,a),r.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),r.end({success:!0,requestId:a.requestId}),a}catch(i){const s=t.nestedAppAuthAdapter.fromBridgeError(i);throw t.eventHandler.emitEvent(p.t.ACQUIRE_TOKEN_FAILURE,l.s_.Popup,null,i),r.end({errorCode:s.errorCode,subErrorCode:s.subError,success:!1}),s}})()}acquireTokenSilentInternal(e){var t=this;return(0,d.Z)(function*(){t.eventHandler.emitEvent(p.t.ACQUIRE_TOKEN_START,l.s_.Silent,e);const r=t.performanceClient.startMeasurement(m.Ak.SsoSilent,e.correlationId);r?.increment({visibilityChangeCount:0}),r?.add({nestedAppAuthRequest:!0});try{const i=t.nestedAppAuthAdapter.toNaaSilentTokenRequest(e),s=yield t.bridgeProxy.getTokenSilent(i),a=t.nestedAppAuthAdapter.fromNaaTokenResponse(i,s);return t.operatingContext.setActiveAccount(a.account),t.eventHandler.emitEvent(p.t.ACQUIRE_TOKEN_SUCCESS,l.s_.Silent,a),r?.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),r?.end({success:!0,requestId:a.requestId}),a}catch(i){const s=t.nestedAppAuthAdapter.fromBridgeError(i);throw t.eventHandler.emitEvent(p.t.ACQUIRE_TOKEN_FAILURE,l.s_.Silent,null,i),r?.end({errorCode:s.errorCode,subErrorCode:s.subError,success:!1}),s}})()}acquireTokenPopup(e){var t=this;return(0,d.Z)(function*(){return t.acquireTokenInteractive(e)})()}acquireTokenRedirect(e){throw n.createUnsupportedError()}acquireTokenSilent(e){var t=this;return(0,d.Z)(function*(){return t.acquireTokenSilentInternal(e)})()}acquireTokenByCode(e){throw n.createUnsupportedError()}acquireTokenNative(e,t,r){throw n.createUnsupportedError()}acquireTokenByRefreshToken(e,t){throw n.createUnsupportedError()}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){throw n.createUnsupportedError()}removePerformanceCallback(e){throw n.createUnsupportedError()}enableAccountStorageEvents(){throw n.createUnsupportedError()}disableAccountStorageEvents(){throw n.createUnsupportedError()}getAccount(e){throw n.createUnsupportedError()}getAccountByHomeId(e){const t=this.operatingContext.getActiveAccount();return void 0!==t&&t.homeAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}getAccountByLocalId(e){const t=this.operatingContext.getActiveAccount();return void 0!==t&&t.localAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}getAccountByUsername(e){const t=this.operatingContext.getActiveAccount();return void 0!==t&&t.username===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}getAllAccounts(){const e=this.operatingContext.getActiveAccount();return void 0!==e?[this.nestedAppAuthAdapter.fromNaaAccountInfo(e)]:[]}handleRedirectPromise(e){throw n.createUnsupportedError()}loginPopup(e){if(void 0!==e)return this.acquireTokenInteractive(e);throw n.createUnsupportedError()}loginRedirect(e){throw n.createUnsupportedError()}logout(e){throw n.createUnsupportedError()}logoutRedirect(e){throw n.createUnsupportedError()}logoutPopup(e){throw n.createUnsupportedError()}ssoSilent(e){return this.acquireTokenSilentInternal(e)}getTokenCache(){throw n.createUnsupportedError()}getLogger(){return this.logger}setLogger(e){this.logger=e}setActiveAccount(e){this.logger.warning("nestedAppAuth does not support setActiveAccount")}getActiveAccount(){const e=this.operatingContext.getActiveAccount();return void 0!==e?this.nestedAppAuthAdapter.fromNaaAccountInfo(e):null}initializeWrapperLibrary(e,t){}setNavigationClient(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}getConfiguration(){return this.config}isBrowserEnv(){return this.operatingContext.isBrowserEnvironment()}getBrowserCrypto(){return this.browserCrypto}getPerformanceClient(){throw n.createUnsupportedError()}getRedirectResponse(){throw n.createUnsupportedError()}preflightBrowserEnvironmentCheck(e,t){throw n.createUnsupportedError()}clearCache(e){return(0,d.Z)(function*(){throw n.createUnsupportedError()})()}hydrateCache(e,t){return(0,d.Z)(function*(){throw n.createUnsupportedError()})()}}}}]);